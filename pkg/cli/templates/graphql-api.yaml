# mockd.yaml - GraphQL API Template
# Generated by: mockd init --template graphql-api
# Documentation: https://mockd.io/docs
#
# This template provides a GraphQL API with:
# - User type with CRUD operations
# - Query and Mutation types
# - Introspection enabled for tooling
#
# Start server: mockd serve --config mockd.yaml
# Test: curl -X POST http://localhost:4280/graphql -H "Content-Type: application/json" -d '{"query": "{ users { id name } }"}'

version: "1.0"

mocks:
  # GraphQL API endpoint
  - id: graphql-graphql-api
    name: GraphQL API
    type: graphql
    enabled: true
    graphql:
      path: /graphql
      # Enable introspection for GraphQL tooling (GraphiQL, Apollo, etc.)
      introspection: true
      # GraphQL Schema Definition
      schema: |
        type Query {
          # Get all users with optional filtering
          users(status: String): [User!]!
          # Get a single user by ID
          user(id: ID!): User
          # Get current authenticated user
          me: User
        }

        type Mutation {
          # Create a new user
          createUser(input: CreateUserInput!): User!
          # Update an existing user
          updateUser(id: ID!, input: UpdateUserInput!): User
          # Delete a user
          deleteUser(id: ID!): Boolean!
        }

        type User {
          id: ID!
          email: String!
          name: String!
          role: Role!
          status: Status!
          createdAt: String!
          updatedAt: String
          profile: Profile
        }

        type Profile {
          bio: String
          avatar: String
          location: String
        }

        input CreateUserInput {
          email: String!
          name: String!
          role: Role
        }

        input UpdateUserInput {
          email: String
          name: String
          role: Role
          status: Status
        }

        enum Role {
          ADMIN
          USER
          GUEST
        }

        enum Status {
          ACTIVE
          INACTIVE
          PENDING
        }

      # Resolver configurations
      resolvers:
        # Query resolvers
        Query.users:
          response:
            - id: "user_001"
              email: "alice@example.com"
              name: "Alice Smith"
              role: "ADMIN"
              status: "ACTIVE"
              createdAt: "2024-01-15T10:30:00Z"
              profile:
                bio: "Platform administrator"
                avatar: "https://example.com/avatars/alice.png"
                location: "San Francisco, CA"
            - id: "user_002"
              email: "bob@example.com"
              name: "Bob Johnson"
              role: "USER"
              status: "ACTIVE"
              createdAt: "2024-01-16T14:20:00Z"
              profile:
                bio: "Software developer"
                location: "New York, NY"
            - id: "user_003"
              email: "carol@example.com"
              name: "Carol Williams"
              role: "USER"
              status: "PENDING"
              createdAt: "2024-01-17T09:15:00Z"

        Query.user:
          response:
            id: "user_001"
            email: "alice@example.com"
            name: "Alice Smith"
            role: "ADMIN"
            status: "ACTIVE"
            createdAt: "2024-01-15T10:30:00Z"
            updatedAt: "2024-01-18T16:45:00Z"
            profile:
              bio: "Platform administrator"
              avatar: "https://example.com/avatars/alice.png"
              location: "San Francisco, CA"

        Query.me:
          response:
            id: "user_current"
            email: "me@example.com"
            name: "Current User"
            role: "USER"
            status: "ACTIVE"
            createdAt: "2024-01-10T08:00:00Z"

        # Mutation resolvers
        Mutation.createUser:
          response:
            id: "user_new"
            email: "newuser@example.com"
            name: "New User"
            role: "USER"
            status: "PENDING"
            createdAt: "{{now}}"

        Mutation.updateUser:
          response:
            id: "user_001"
            email: "alice.updated@example.com"
            name: "Alice Smith (Updated)"
            role: "ADMIN"
            status: "ACTIVE"
            createdAt: "2024-01-15T10:30:00Z"
            updatedAt: "{{now}}"

        Mutation.deleteUser:
          response: true

  # HTTP endpoint for GraphQL playground info
  - id: graphql-graphql-info
    name: GraphQL Info
    type: http
    enabled: true
    http:
      matcher:
        method: GET
        path: /graphql/info
      response:
        statusCode: 200
        headers:
          Content-Type: application/json
        body: |
          {
            "endpoint": "/graphql",
            "introspection": true,
            "playground": "Use any GraphQL client or playground tool",
            "examples": {
              "listUsers": "query { users { id name email role } }",
              "getUser": "query { user(id: \"user_001\") { id name email profile { bio } } }",
              "createUser": "mutation { createUser(input: { email: \"test@example.com\", name: \"Test User\" }) { id name } }",
              "deleteUser": "mutation { deleteUser(id: \"user_001\") }"
            }
          }

# Next steps:
# 1. Run: mockd serve --config mockd.yaml
# 2. Test with curl:
#    curl -X POST http://localhost:4280/graphql \
#      -H "Content-Type: application/json" \
#      -d '{"query": "{ users { id name email } }"}'
# 3. Use a GraphQL client like:
#    - GraphiQL
#    - Apollo Studio
#    - Postman
#    - Insomnia
# 4. Introspection query:
#    curl -X POST http://localhost:4280/graphql \
#      -H "Content-Type: application/json" \
#      -d '{"query": "{ __schema { types { name } } }"}'
# 5. Customize the schema and resolvers for your API
